@model EveShopping.Models.EDVImportFits

@{
    ViewBag.Title = "New";
    ViewBag.FullTitle = "EVE-shopping list fits: " + Model.ShoppingListName;
}

<div id="list-main">
    <div class="inside-section">
        <h3 class="main-title clearfix"><span>Fits in shopping list </span><span class="right">
            @if (Model.Fittings.Count() > 0)
            {
                <span id="total-price-vol">@EveShopping.Web.VSHMappings.GetNormalizedPrice(EveShopping.Web.Agentes.AgenteShoppingList.CalculateTotalPrice(Model.Fittings)) - @EveShopping.Web.Agentes.AgenteShoppingList.CalculateTotalVolume(Model.Fittings) m3</span>
            }
            else
            {
                <span id="total-price-vol"></span>
            }

        </span></h3>
        <div id="fitsInList" class="subs-wrapper" data-esh-fits-in-list>
            @if ((this.Model.Fittings != null) && this.Model.Fittings.Count() > 0)
            {
                Html.RenderPartial("PVFitsInShoppingList", this.Model.Fittings);
            }
        </div>
        <div id="links-navegacion-pasos-container">
            @Html.ActionLink("Add market items >>", "AddMarketItems", new { id = this.ViewBag.PublicID }, new { @class = "buttonYellow" })
        </div>

    </div>
</div>

<input id="fitPublicId" type="hidden" value="@ViewBag.FitPublicId" />


@section scripts{
    <script src="~/Scripts/eshImportFits.js" type="text/javascript">
    </script>
}

@section izquierda{


    <div id="list-left-menu">
        <div class="inside-section">
            <h3>Import fits</h3>
            @using (Ajax.BeginForm("AnalyzeRawFit", new AjaxOptions { UpdateTargetId = "fitsAnalysed", OnSuccess = "ReactivateImportedFitsAccordion", OnFailure = "onFailureAnalyzeRawFit" }))
            {
                <form id="payment">
                    <fieldset>
                        <legend>Raw fit</legend>
                        <textarea id="rawFit" name="rawFit" rows="5" placeholder="Paste here the fit that you want to import from EVE or supported fitting tools" required></textarea>
                        <button type="submit" class="buttonYellow" value="Analyse">Analyse</button>
                    </fieldset>
                </form>
            }
            <div id="fitsAnalysed" class="subs-wrapper" data-esh-analysed-fits>
            </div>
        </div>
    </div>
}

@section subheader{
    <div id="subheader-container" class="wrapper clearfix">
        <ul id="menu-pasos">
            <li class="selected">@Html.ActionLink("Add ship fittings", "ImportFits", "Lists", new { id = this.ViewBag.PublicID }, null)</li>
            <li>@Html.ActionLink("Add market items", "AddMarketItems", "Lists", new { id = this.ViewBag.PublicID }, null)</li>
            <li>@Html.ActionLink("Summary", "Summary", "Lists", new { id = this.ViewBag.PublicID }, null)</li>
        </ul>
    </div>

}

@section ayuda{
    <div id="help-container" class="notVisible">
        <h3><span>Add fittings to shopping list</span></h3>
        <div>
            <p>In this step you will be able to add any fit you want to include in the shopping list, follow the next steps:</p>
            <p>Paste your fittings and analyse them on the analyse section. You can use fits exported from EVE Online (support file with multiple fittings) and EFT. </p>
            <p>Select the fits that you want to use from the imported section</p>
            <p>Edit them and set the amount of units of this fit that you want to include in your shopping list</p>
            <p>Shopping list is completed in 3 steps, you can navigate following the buttons at the end of the main section or using the shopping list navigation bar.</p>
        </div>
    </div>
}