@model EveShopping.Models.EDVImportFits

@{
    ViewBag.Title = "New";
    ViewBag.FullTitle = "EVE-shopping list fits: " + Model.ShoppingListName;
}

<div id="list-main">
    <div class="inside-section">
        <h3 class="main-title clearfix"><span>Fits in shopping list </span><span class="right">
            @if (Model.Fittings.Count() > 0)
            {
                <span id="total-price-vol">@EveShopping.Web.VSHMappings.GetNormalizedPrice(EveShopping.Web.Agentes.AgenteShoppingList.CalculateTotalPrice(Model.Fittings)) - @EveShopping.Web.Agentes.AgenteShoppingList.CalculateTotalVolume(Model.Fittings) m3</span>
            }
            else
            {
                <span id="total-price-vol"></span>
            }

        </span></h3>
        <p>It is possible to change the units that you want for each fit in your shopping list.</p>
        <div id="fitsInList" class="subs-wrapper" data-esh-fits-in-list>
            @if ((this.Model.Fittings != null) && this.Model.Fittings.Count() > 0)
            {
                Html.RenderPartial("PVFitsInShoppingList", this.Model.Fittings);
            }
        </div>
        <div id="links-navegacion-pasos-container">
            @Html.Partial("PVIncludeListInMyLists", new { ListDoesntHaveOwner = Model.IsShoppingListFree })
            @Html.ActionLink("Add market items >>", "AddMarketItems", new { id = this.ViewBag.PublicID }, new { @class = "buttonYellow" })
        </div>

    </div>
</div>

<input id="fitPublicId" type="hidden" value="@ViewBag.FitPublicId" />


@section scripts{
    <script src="~/Scripts/eshImportFits.js" type="text/javascript">
    </script>
}

@section izquierda{


    <div id="list-left-menu">
        <div class="inside-section">
            <h3>Import fits</h3>
            <p>Use this panel to import your fits into the shopping list. You can see more information about how to export them in the help.</p>
            @using (Ajax.BeginForm("AnalyzeRawFit", new AjaxOptions { UpdateTargetId = "fitsAnalysed", OnSuccess = "ReactivateImportedFitsAccordion", OnFailure = "onFailureAnalyzeRawFit" }))
            {
                <form id="payment">
                    <fieldset>
                        <legend>Raw fit</legend>
                        <textarea id="rawFit" name="rawFit" rows="5" placeholder="Paste here the fit that you want to import from EVE or supported fitting tools" required></textarea>
                        <button type="submit" class="buttonYellow" value="Analyse">Analyse</button>
                    </fieldset>
                </form>
            }
            <div id="fitsAnalysed" class="subs-wrapper" data-esh-analysed-fits>
            </div>
        </div>
    </div>
}

@section subheader{
    <div id="subheader-container" class="wrapper clearfix">
        <ul id="menu-pasos">
            <li class="selected">@Html.ActionLink("Add ship fittings", "ImportFits", "Lists", new { id = this.ViewBag.PublicID }, null)</li>
            <li>@Html.ActionLink("Add market items", "AddMarketItems", "Lists", new { id = this.ViewBag.PublicID }, null)</li>
            <li>@Html.ActionLink("Summary", "Summary", "Lists", new { id = this.ViewBag.PublicID }, null)</li>
        </ul>
    </div>

}

@section ayuda{
    <div id="help-container" class="notVisible">
        <h3><span>Add fittings to shopping list</span><span class="right">(open for help)</span></h3>
        <div>
            <p>In this step you will be able to add any fit you want to include in the shopping list. For that you need to copy in the clipboard your fitting and paste in the text area contained in the left panel of this screen.</p>
            <p>The format recognised are <strong>EVE XML (recommended format)</strong>, EFT and DNA (not yet).</p>
            <p>It is possible to import fits in different ways:</p>
            <p>- Inside Eve: Drag your fit to any eve chat and copy the link (you need to actually enter the fit in the chat, is not enough to drag it and copy, need to drag and press enter in the chat). This will provide a DNA fit what you can paste in our text area. See a video here (add link to video).</p>
            <p>- Export fits from EVE to xml in the EVE Docs folder. You can open the XML file with your favorite editor, copy the content and paste it to our text area. See a video here (add link to video).</p>
            <p>- From your favorite EVE fitting tool, like EFT, Pyfa or EVEHQ. These tools have many ways to export their fits or copy them to clipboard. If you have the chance, export it to the prefered format: XML.</p>
            <p>Once your fit is analysed, you can use it in your shopping list and set the units that you want to buy.</p>
        </div>
    </div>
}